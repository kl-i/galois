\documentclass[../book.tex]{subfiles}

\begin{document}
In this section, we deal with when minimal polynomials having multiple roots.

\begin{rmk}
    The following is intimately related to when
    polynomials can have multiple roots or not.
\end{rmk}

\begin{dfn} Characteristic of a Field.
    
    Let $K$ be a field. 
    Since $\Z$ is generated by $1$ as a ring
    and all ring morphisms $\Z \to K$ must map $1_\Z$ to $1_K$,
    we have only one ring morphism from $\iota_\Z : \Z \to K$. 
    $\ker \iota_\Z$ is an ideal of $\Z$ so by $\Z$ being a PID,
    there exists an element $p \in \Z$
    that that generates $\ker \iota_\Z$ as an ideal.
    $p$ can be made non-negative. 
    Then the \textbf{characteristic of $K$} is defined as this $p$. 
    We will denote it with $\chi_K$. 
\end{dfn}
\begin{thm} Characteristics are Zero or Prime.
    
    Let $K$ be a field and $\chi_K$ its characteristic.
    Then $\chi_K$ is zero or prime. 
\end{thm}
\begin{proof}
    By the 1st isomorphism theorem, 
    \[ \Z/ (\chi_K) = \Z / \ker \iota_\Z \iso_\Ring \iota_\Z \Z \subseteq K\]
    where $\iota_\Z$ is the canonical ring morphism from $\Z$ into $K$.
    Since fields are integral rings
    and subrings of integral domains are integral,
    $\Z / (\chi_K)$ is an integral domain.
    If $\chi_K$ is zero, we are done.
    If $\chi_K$ is non-zero, note that $\iota_\Z$ cannot be the zero map
    since $1 \neq 0$ in the field $K$. 
    Hence $\chi_K$ is cannot be a unit. 
    So $\chi_K$ is a non-zero non-unit 
    which generates an ideal with an integral quotient ring
    i.e. $\chi_K$ is prime.
\end{proof}
\begin{dfn} Multiplicity of Roots.
    
    Let $f$ be a polynomial over $K$ and 
    $\iota_L : K \to L$ an extension splitting $f$.
    Let $S_f$ be the set of roots of $f$ inside $L$. 
    Then we have, \[
            \bar\iota_L f = \iota(\la) \prod_{a\in S_f} (X - a)^{m_a}
    \]
    where $\la \in K$. 
    For a root $a \in S_f$, $m_a$ is called its \textbf{multiplicity}.
    The multiplicities of roots are actually independent of the extension $L$,
    since any $L$ that splits $f$ contains a splitting field of $f$
    and inside the splitting field, $\bar{\iota_L} f$ is the same as in $L$
    as well as inside any other splitting field since 
    any two splitting fields of $f$ are isomorphic. 
    A root $a$ with multiplicity larger than one is called a \textbf{repeated root}.
\end{dfn}
Before we introduce the three equivalent definitions of separability, 
we will need to following two lemmas. 
\begin{lem} GCD stays the same moving up Extensions. 
    
    Let $f, g$ be polynomials over $K$ and $\iota_L : K \to L$ an extension.
    Let $h \in K[X]$ be a gcd of $f, g$. 
    Then $\bar\iota_L h$ is a gcd of $\bar\iota_L f, \bar\iota_L g$. 
    In particular, distinct irreducible polynomials remain coprime 
    when moving up an extension. 
\end{lem}
\begin{proof}
    Let $h_1$ be a gcd of $\bar\iota_L f$ and $\bar\iota_L g$. 
    Clearly, $\bar\iota_L h$ divides $\bar\iota_L f$ and $\bar\iota_L g$. 
    So $h_1$ divides $\bar\iota_L h$. 
    Then any polynomial in $L[X]$ dividing both $\bar\iota_L f$ and $\bar\iota_L g$
    divides $h_1$ and hence divides $\bar\iota_L h$. 
    Thus, $\bar\iota_L h$ is a gcd of $\bar\iota_L f$ and $\bar\iota_L g$. 
\end{proof}
\begin{rmk}
    The above lemma is significant because it says
    if $f$ has a repeated root, then that repeated root belongs to 
    \emph{only one} of its irreducible factors, 
    because the gcd of any two distinct irreducible factors is $1$. 
    Hence, $f$ has a repeated root if and only if it has some
    irreducible factor with repeated roots. 
    This means from now on when considering the issue of repeated roots, 
    we only need to consider irreducible polynomials. 
\end{rmk}
\begin{lem} Freshmen's Dream.
    
    Let $K$ be a field where $\chi_K \neq 0$ in $\Z$. 
    Then for all $a, b \in K$, \[
        (a+b)^{\chi_K} = a^{\chi_K} + b^{\chi_K}
    \]
\end{lem}
\begin{proof}
    Follows from the binomial theorem and $\chi_K = 0$ in $K$. 
\end{proof}
%    - Def - Sep Ext, 2 Eqv defs
%          - Contrapositive
%    - Def - Sep Element over a Field, Sep Ext
\begin{dfn} Seperable, Separable Extensions
% Multiple definitions taken from John Milne's Galois notes. 

    Let $f$ be an irreducible polynomial over $K$. 
    The following are equivalent: 
    \begin{enumerate}
        \item There exists a $K$-extension $\iota_L : K \to L$ splitting $f$ where
        $f$ has a root with multiplicity higher than 1, i.e. a repeated root.
        \item Suppose $f = \sum_{k \leq \deg f} f_k X^k \in K[X]$.
        Define its formal derivative as 
        \[ f' := \sum_{k < \deg f} (k+1)f_{k+1}X^k \]
        Then $(f,f') \neq 1$.
        \item $\chi_K$ is non-zero and there exists a polynomial $g$ over $K$
        such that $f = g(X^{\chi_K})$.
    \end{enumerate}
    If any of the above is true, then $f$ is called \textbf{inseparable}.
    Otherwise, it is called \textbf{separable}.
    Note that (3) implies polynomials over fields with characteristic zero
    are automatically separable. 
    
    Let $\iota_L : K \to L$ be a finite $K$-extension.
    Then $(L,\iota_L)$ is called a \textbf{separable extension} when
    all minimal polynomials of elements are separable. 
\end{dfn}
\begin{proof}
    ($1\imp 2$)
    
        Let $\iota_L : K \to L$ be a $K$-extension 
        and let $S_f$ be the set of roots of $f$ in $L$ so that \[
            \bar\iota_L f = \iota_L(\la) \prod_{a\in S_f} (X - a)^{m_a}
        \]
        and there exists an $a$ such that $m_a > 1$. 
        WLOG, let $m_a = 2$.
        Suppose $(f,f') = 1$ in $K[X]$. 
        Then by the previous lemma, $(\bar\iota_L f, \bar\iota_L f') = 1$. 
        However, by the product rule\footnote{
        Prove it yourself if you can be arsed.
        Strong induction is your friend.}, 
        $\bar\iota_L f'$ has a factor of $(X - a)$
        which $\bar\iota_L f$ also has as a factor, i.e.
        $(\bar\iota_L f, \bar\iota_L f') \neq 1$.
        We have a contradiction, hence $(f,f') \neq 1$. 
    
    ($2\imp 3$)
    
        By definition, there exists a polynomial $g \in K[X]$ such that 
        \[f = (f,f') g\]
        By irreducibility of $f$, $(f,f')$ is a unit or $g$ is a unit. 
        Since $(f,f') \neq 1$, we have $g$ is a unit, 
        which implies $f$ divides $f'$.
        We know $f$ is non-zero. 
        Suppose $f'$ is non-zero as well.
        Then we have $\deg f \leq \deg f'$ whilst $\deg f' < \deg f$,
        a contradiction. 
        Thus $f'$ must be zero. 
        Let $f = \sum_{k\leq\deg f} f_k X^k$. 
        Then we have \[
            0 = \sum_{k < \deg f} (k+1) f_{k+1} X^k
        \]
        which implies for all $k < \deg f$, $(k+1) f_{k+1} = 0$.
        Then when the coefficients of $f$ are non-zero, we have $k+1 = 0$.
        This implies the kernel of the canonical ring morphism 
        $\Z \to K$ is non-trivial. 
        Hence, $\chi_K$ is non-zero. 
        Furthermore, for non-zero coefficients $f_{k+1}$, 
        $k+1 = 0$ implies there exist $n_k$ such that $k+1 = n_k\chi_K$ in $\Z$
        since $\chi_K$ generates the kernel of $\Z \to K$. 
        Letting $g := f_0 + \sum_{k<\deg f} f_{k+1}X^{n_k}$,
        we have $f = g(X^{\chi_K})$.\footnote{
            Composition of polynomials is such that $(X^a)^b=X^{ab}$.
            This comes from the interpretation of polynomials over a field $K$
            as a function from $K$ to itself. 
        }
        
    ($3\imp 1$)
    
        Let $\chi_K \neq 0$ and $f = g(X^{\chi_K})$
        for some polynomial $g \in K[X]$.
        There exists an extension $\iota_M : K \to M$ that splits $g$. 
        Then inside $M[X]$ we have \[
            \bar\iota_M f = \bar\iota_M g(X^{\chi_K})
            = \iota_M(\la) \prod_{i < \deg g} (X^{\chi_K} - b_i)
        \]
        where $\la \in K$ and $b_i \in M$. 
        Furthermore, there exists an extension $\iota : M \to L$ 
        that splits $\bar\iota_M f$.
        Let $(L,\iota_L) := (L,\iota\circ\iota_M)$. 
        Then for all $b_i$, we have an $a_i \in L$ such that $a_i^{\chi_K} = b_i$. 
        Hence we have \begin{align*}
            \bar\iota_L f &= \bar\iota_L g(X^p) 
            = \iota_L(\la) \prod_{i < \deg g}  (X^{\chi_K} - a_i^{\chi_J}) \\
            &= \iota_L(\la) \prod_{i < \deg g}  (X - a_i)^{\chi_K}  
        \end{align*}
        where the second line comes from Freshmen's dream. 
        Thus in fact, \emph{all} the roots of $f$ have multiplicity larger than 1. 
\end{proof}
%    - Def - Deg Sep as Cardinality of Maps into any Normal Extension 
%            (Well def via Maps into Normal Closure)
\begin{dfn} Seperable Degree. 
    
    Let $\iota_L : K \to L$ be an extension. 
    Let $\iota_M : L \to M$ be an extension such that 
    $(M,\iota_M\circ\iota_L)$ is normal. 
    Then the \textbf{separable degree of $(L,\iota_L)$} is
    the number of $K$-extension morphisms 
    from $(L,\iota_L)$ to $(M,\iota_M\circ\iota_L)$.
    This is denoted $[L : K]_S$. 
    
    We prove below that for any choice of $M$,
    the separable degree is equal to when $M$ is chosen to be 
    the normal closure of $(L,\iota_L)$.
    Hence it is well-defined.
\end{dfn}
\begin{proof}
    Let $(N,\iota_N)$ be the normal closure of $(L,\iota_L)$.
    Let $(M,\iota_M)$ be another $L$-extension such that 
    $(M,\iota_M\circ\iota_L)$ is normal. 
    By the minimal property of the normal closure, 
    we have an $L$-extension $\bar\iota_M : N \to M$. 
    The situation is this. 
    \begin{figure} [H]
        \centering
        \begin{tikzcd} [sep = huge]
        & 
        & 
        N \arrow[d,"\bar{\iota_M}"] \\
        K \arrow[r,"\iota_L"] &
        L \arrow[ru,"\iota_N"{sloped,below}]
        \arrow[ru,"\phi"{sloped,above},xshift=-0.7ex, yshift=0.7ex] 
        \arrow[rd,"\iota_M"{sloped,above}] 
        \arrow[rd,"f"{sloped,below},xshift=-0.7ex, yshift=-0.7ex] &
        \bar{\iota_M} N \arrow[d,"\subseteq"] 
        \arrow[loop right,"\res{\bar{f}}{\bar{\iota_M} N}"] \\
        & 
        &
        M \arrow[loop right,"\bar{f}"]
        \end{tikzcd}
    \end{figure}
    Let $\mor{K}{L}{N}$ denote the set of $K$-extension morphisms
    from $(L,\iota_L)$ to $(N,\iota_N\circ\iota_L)$
    and similarly $\mor{K}{L}{M}$ for $(M,\iota_M\circ\iota_L)$. 
    Let $\phi \in \mor{K}{L}{N}$. Then clearly, 
    $\bar\iota_M \circ \phi$ is a $K$-extension morphism 
    from $(L,\iota_L)$ to $(M,\iota_M\circ\iota_L)$. 
    So we have the following function, \[
        (\bar\iota_M \circ - ) : \mor{K}{L}{N} \to \mor{K}{L}{M}, 
        \phi \mapsto \bar\iota_M \circ \phi
    \]
    We claim this is a bijection. 
    Since $\bar\iota_M$ is injective, $(\bar\iota_M \circ -)$ is injective as well.
    
    We now show surjectivity. 
    Let $f \in \mor{K}{L}{M}$. 
    Then we have an $L$-extension $\bar{f} : (M,\iota_M) \to (M,f)$
    since two embeddings into a normal extension differ by an automorphism. 
    Then $\bar\iota_M$ and $\bar{f}\circ\bar\iota_M$ are
    both $K$-extension morphisms from
    $(N,\iota_N\circ\iota_L)$ to $(M,\iota_M\circ\iota_L)$.
    Hence by image invariance definition of normality, 
    the restriction of $\bar{f}$ to $\bar{\iota_M} N$ is 
    a well-defined bijective $L$-extension morphism, \[
        \res{\bar{f}}{\bar{\iota_M} N} : \bar{\iota_M} N \to \bar{\iota_M} N,
        x \mapsto \bar{f}(x)
    \]
    Then $\bar{\iota_M}^{-1} \circ \res{\bar{f}}{\bar{\iota_M}N} 
    \circ \bar{\iota_M} \circ \iota_N $ is a $K$-extension morphism
    from $(L,\iota_L)$ to $(N,\iota_N)$. 
    This clearly maps to $f$ via $(\bar{\iota_M} \circ -)$. 
\end{proof}
We now have the a second tower law. 
%    - Thm - Tower Law of Deg Sep
\begin{thm} Tower Law of Seperable Degree. 
    
    Let $K \overset{\iota_L}{\to} L \overset{\iota_M}{\to} M$ be extensions.
    Then $[M : K]_S = [M : L]_S [L : K]_S$.
\end{thm}
\begin{proof}
    Let $\iota_N : M \to N$ be an extension such that 
    $(N,\iota_N\circ\iota_M\circ\iota_L)$ is normal. 
    Let $\mor{K}{M}{N}, \mor{K}{L}{N}$ be the sets of $K$-extensions
    from respectively $(M,\iota_M\circ\iota_L)$ and $(L,\iota_L)$ 
    to $(N,\iota_N\circ\iota_M\circ\iota_L)$. 
    Then $[M:K]_S = |\mor{K}{M}{N}|$ and $[L:K]_S = |\mor{K}{L}{N}|$.
    Similarly, let $\mor{L}{M}{N}$ be the set of $L$-extensions
    from $(M,\iota_M)$ to $(N,\iota_N\circ\iota_M)$ so that 
    $[M:L]_S = |\mor{L}{M}{N}|$.
    We want to show \[
        |\mor{K}{M}{N}| = |\mor{L}{M}{N}| |\mor{K}{L}{N}|
    \]
    We start by noting that by restricting to $L$, 
    the $K$-extension morphisms from $M$ to $N$,
    we obtain $K$-extension morphisms from $L$ to $N$, i.e.
    \[
        (- \circ \iota_M) : \mor{K}{M}{N} \to \mor{K}{L}{N}, 
        \phi \mapsto \phi\circ\iota_M
    \]
    is a well-defined function. 
    We will show this is surjective and 
    the preimages of elements in $\mor{K}{L}{N}$ 
    all have cardinality $|\mor{L}{M}{N}|$.
    Then since the preimages of elements in $\mor{K}{L}{N}$ form
    a partition of $\mor{K}{M}{N}$, we have our desired result. 
    
    We now show surjectivity. 
    Let $f \in \mor{K}{L}{N}$. 
    The situation is this: \begin{figure}[H]
        \centering
        \begin{tikzcd}
        K \arrow[r,"\iota_L"] &
        L \arrow[r,"\iota_M"] \arrow[rd,"f"{sloped,below}] &
        M \arrow[d,"\iota_N"] \\
        & 
        &
        N \arrow[loop right,"\bar{f}"]
        \end{tikzcd}
    \end{figure}
    Then since two embeddings into a normal extension differ by an automorphism,
    we have an $L$-extension morphism $\bar{f}$ 
    from $(N,\iota_N\circ\iota_M)$ to $(N,f)$. 
    Then $\bar{f}\circ\iota_M : M \to N$ is clearly
    a $K$-extension morphism from $(M,\iota_M\circ\iota_L)$ 
    to $(N,\iota_N\circ\iota_M\circ\iota_L)$ that restricts to $f$. 
    
    Let $f \in \mor{K}{L}{N}$. 
    We now show that $(- \circ \iota_M)^{-1}(f)$ bijects with $\mor{L}{M}{N}$.
    Let $\phi \in (- \circ \iota_M)^{-1}(f)$.
    Then \[
        \phi\circ\iota_M = f = \bar{f}\circ\iota_N\circ\iota_M 
        \imp \bar{f}^{-1}\circ\phi\circ\iota_M = \iota_N\circ\iota_M 
    \]
    which says $\bar{f}^{-1}\circ\phi$ is a $L$-extension morphism
    from $(M,\iota_M)$ to $(N,\iota_N\circ\iota_M)$.
    That is to say we have the following function, \[
        (\bar{f}^{-1} \circ -) : (- \circ \iota_M)^{-1}(f) \to \mor{L}{M}{N},
        \phi \mapsto \bar{f}^{-1}\circ\phi
    \]
    By injectivity of $\bar{f}^{-1}$, $(\bar{f}^{-1} \circ -)$ is injective.
    Let $\psi \in \mor{L}{M}{N}$. Then \[
        \bar{f}\circ\psi\circ\iota_M = \bar{f}\circ\iota_N\circ\iota_M = f
    \]
    i.e. $\bar{f}\circ\psi \in (- \circ \iota_M)^{-1}(f)$.
    Clearly, $\bar{f}\circ\psi$ maps to $\psi$.
    This proves surjectivity and completes the proof. 
\end{proof}
We now move towards three equivalent charactersations of separable extensions. 
First, a lemma. 
%    - Lem - Separability Inheritance
\begin{lem} 
    
    Let $K \overset{\iota_L}{\to} L \overset{\iota_M}{\to} M$ be extensions
    and $a \in M$, $b \in L$. 
    Then $\min(a,K)$ separable implies $\min(a,L)$ separable
    and $\min(\iota_M(b),K)$ implies $\min(b,K)$ separable.
    Consequently, $(M,\iota_M\circ\iota_L)$ separable implies
    both $(L,\iota_L)$ and $(M,\iota_M)$ separable. 
\end{lem}
\begin{proof}
    Let $\min(a,K)$ be separable.
    $\min(a,L)$ divides $\min(a,K)$. 
    Since $\min(a,K)$ is separable, it has no repeated roots,
    which clearly implies $\min(a,L)$ also has no repeated roots. 
    Hence $\min(a,L)$ is separable. 
    
    Let $\min(\iota_M(b),K)$ be separable. 
    Since $\min(\iota_M(b),K) = \min(b,K)$, $\min(b,K)$ is separable, too. 
\end{proof}
%    - Thm - For K(a), Deg Sep = Deg Ext iff a sep over K 
%          - Key : Roots <-> Maps from K(a)
%    - Lem - Simp Ext Sep iff Sep Deg = Ext Deg
%          - Key : Ineq Trick
\begin{thm} Equivalent Conditions for Simple Algebraic to be Separable.

    Let $\iota : K \to K(a)$ be a simple extension where $a$ is algebraic over $K$.
    Then the following are equivalent: 
    \begin{enumerate}
        \item $\min(a,K)$ is separable.
        \item $[K(a) : K]_S = [K(a) : K]$
        \item $\iota : K \to K(a)$ is a separable extension. 
    \end{enumerate}
\end{thm}
\begin{proof}
    ($1\iff 2$)
    
        Let $(N,\iota_N)$ be a $K(a)$-extension where 
        $(N,\iota_N\circ\iota)$ is normal. 
        Then $N$ splits $\min(a,K)$. 
        Hence by embedding via conjugates for simple extensions,
        the number of $K$-extension morphisms 
        from $(K(a),\iota)$ to $(N,\iota_N\circ\iota)$
        is equal to the number of distinct Galois conjugates of $a$
        inside $N$. 
        This is equal to $\deg\min(a,K)$, which equals $[K(a):K]$,
        if and only if $\min(a,K)$ is separable. 
        
    ($3\imp 1$) 
        Trivial.
    
    ($2 \imp 3$)
        Let $b \in K(a)$. We use $1,2$ on $b$ to prove this implication. 
        Let $(N,\iota_N)$ be a $K(a)$-extension such that 
        $N$ is normal as a $K(b)$-extension. 
        We have the following trick of inequalities. 
        Then by embedding via conjugates from $K(b)$ to $N$, 
        we have $[K(a):K(b)]_S \leq [K(a):K(b)]$.
        Then by the tower laws of separable degree and extension degree,
        \begin{align*}
            [K(a) : K]_S &= [K(a):K(b)]_S [K(b):K]_S \\
            &\leq [K(a):K(b)] [K(b):K]_S \\
            &\leq [K(a):K(b)] [K(b):K] = [K(a):K] = [K(a):K]_S
        \end{align*}
        Hence we have equality everywhere, giving 
        $[K(b):K]_S = [K(b):K]$ which implies $\min(b,K)$ is separable.
        Thus, $K(a)$ is a separable extension. 
\end{proof}
The generalisation of the above to finite extensions is what we are after. 
%    - Thm - General Ext Sep iff Sep Deg = Ext Deg
%          - Key : Decompose into Simp Exts AND Ineq Trick
%    - Cor - Ext Sep iff Generators Sep
%          - Key : Decompose into Simp Ext, Tower Law
\begin{thm} 3 Equivalent Definitions for Separable Extensions.
    
    Let $\iota_L : K \to L$ be a finite extension.
    Then the following are equivalent:
    \begin{enumerate}
        \item There exists a finite set of generators $a_0,\dots,a_{n-1}$ of $L$ 
            such that for all $a_i$, $\min(a_i,K)$ is separable. 
        \item $[L:K]_S = [L:K]$.
        \item $(L,\iota_L)$ is separable.
    \end{enumerate}
\end{thm}
\begin{proof}
    ($1\imp 2$)
        
        We break $L$ into finite steps of simple extensions. 
        For $i\in n$, let $K_i := K(a_0,\dots,a_i)$.
        Then $K_{i+1} = K_i(a_{i+1})$. 
        Since $\min(a_{i+1},K)$ is separable, $\min(a_{i+1},K_i)$ is separable as well. 
        Hence by the previous lemma, $[K_{i+1}:K_i]_S = [K_{i+1}:K_i]$. 
        So by the tower laws of separable degree and extension degree applied $n$-times, 
        $[L : K]_S = [L : K]$. 
        
    ($2\imp 3$)
        
        Let $b \in L$. 
        This is the same inequality trick.
        By embedding via conjugates, we have $[L : K(b)]_S \leq [L : K(b)]$. 
        Then by the tower laws of separable degree and extension degree,
        \begin{align*}
            [L : K]_S &= [L : K(b)]_S [K(b) : K]_S \\
            &\leq [L : K(b)] [K(b) : K]_S \\
            &\leq [L : K(b)] [K(b) : K] = [L : K] = [L : K]_S 
        \end{align*}
        So by everywhere equality, we have $[K(b) : K]_S = [K(b) : K]$
        which implies $\min(b,K)$ is separable. 
        
    ($3\imp 1$)
        Trivial. 
\end{proof}
%    - Cor - Splitting Field of Sep Poly is Sep
%    - Cor - Ext Sep iff Normal Closure Sep

    
\end{document}